define(["jquery","common/essentialData","travel/categoryCheckerTravel","home/rocketBadge","./convertBUD"],function($,essentialData,travelCategoryChecker,rocketBadge,convertBUD){var scrollAction={x:"undefined",y:"undefined"},scrollDirection;var ui={load:function(){convertBUD.init();$("#header .bookmark, .top-bar .bookmark").click(function(){var title=Pacifik.formatMessage("coupang.web.0022b1","쿠팡");var url="https://www.coupang.com";if(window.chrome)alert(Pacifik.formatMessage("coupang.web.16f5ac",
"Ctrl+D 키를 누르면 즐겨찾기에 추가하실 수 있습니다."));else if(window.sidebar){alert(Pacifik.formatMessage("coupang.web.da974e","Ctrl+B 키를 누르면 즐겨찾기에 추가하실 수 있습니다."));window.sidebar.addPanel(title,url,"")}else window.external.AddFavorite(url,title)});ui.sidebar();$("#segmentSelect").change(function(){var selected=$(this).val();location.href="/?segment\x3d"+selected})},slide:function(options){var setting={slider:null,size:null,rolling:null,speed:"1000",banner:null,adjust:null,size1hide:false};var options=$.extend(setting,
options);var slider=options.slider;var list=slider.find("ul");var item=list.find("li");var rollingTimer="";var speed=options.speed;var paging=slider.find("ol");var button=slider.find(".move");var size=options.size;var rolling=options.rolling;var view=Math.ceil(item.size()/size);var banner=options.banner;var index=0;var pannelFunc=function(){$(item).hide();$(item).each(function(){var unit=Math.floor($(this).index()/size);if(unit==index)$(this).show();else $(this).hide()})};var pagingFunc=function(){paging.find("li").removeClass("selected");
paging.find("li").eq(index).addClass("selected")};var buttonFunc=function(type){if(type=="next"){index++;if(index>view-1)index=0}else{index--;if(index<0)index=view-1}pagingFunc();pannelFunc()};var rollingFunc=function(type){if(type=="start")rollingTimer=setInterval(function(){buttonFunc("next")},speed);else clearInterval(rollingTimer)};if(rolling){slider.bind({mouseenter:function(){rollingFunc("stop")},mouseleave:function(){rollingFunc("start")}});rollingFunc("start")}var loadFunc=function(){if(item.size()-
1<size)button.hide();if(item.size()==1&&options.size1hide)paging.hide();paging.html("");for(var i=0;i<view;i++)paging.append('\x3cli\x3e\x3ca href\x3d"javascript:;" title\x3d"'+(i+1)+'"\x3e'+(i+1)+"\x3c/a\x3e\x3c/li\x3e");paging.find("li").each(function(){$(this).click(function(){index=$(this).index();pagingFunc();pannelFunc()})});if(banner)if(item.size()-1<size)paging.hide();pagingFunc();pannelFunc()};button.unbind("click").bind("click",function(e){e.preventDefault();if($(this).hasClass("next"))buttonFunc("next");
else buttonFunc("prev");pagingFunc();pannelFunc();if(essentialData.getController()==="home"&&essentialData.getAbTestOptionByKey("2449")==="B")new rocketBadge(slider)});loadFunc()},slide_home:function(options){var setting={slider:null,size:null,rolling:null,speed:"1000",banner:null,adjust:null,dotnavi:null,hiddennavi:false,size1hide:false};var options=$.extend(setting,options),slider=options.slider,list=slider.find("ul"),item=list.find("li"),rollingTimer="",speed=options.speed,button=slider.find(".move"),
size=options.size,rolling=options.rolling,view=Math.ceil(item.size()/size),banner=options.banner,index=0,isDotNaviUse=false,isDotNaviUse=options.dotnavi,isHiddenButtonType=options.hiddennavi||false;if(isDotNaviUse){var dotdata=options.dotnavi.data("slide-dot-navi");var $dotroot=slider.find(dotdata["root"]);var $dotprev=slider.find(dotdata["prev"]);var $dotnext=slider.find(dotdata["next"]);var $dotpageWrap=slider.find(dotdata["wrap"]);var $dotpage=slider.find(dotdata["page"]);var dotNumClass=dotdata["num"];
var dotNowClass=dotdata["now"]}var pannelFunc=function(){var pageBox=slider.find(".current-page");var pageInfo="\x3cem\x3e"+(index+1)+"\x3c/em\x3e/"+view;pageBox.html(pageInfo);item.hide();item.each(function(){var $this=$(this);var unit=Math.floor($this.index()/size);if(unit==index)$this.show();else $this.hide()});naviActiveCheckFunc();if(isDotNaviUse)dotNaviPannelFunc()};var naviActiveCheckFunc=function(){var curPage=index+1;var activeBtn=slider.find(".active");var nextBtn=slider.find(".next");var prevBtn=
slider.find(".prev");if(isHiddenButtonType){if(activeBtn){activeBtn.removeClass("active");prevBtn.hide();nextBtn.hide()}if(curPage<view){nextBtn.show();nextBtn.addClass("active")}else nextBtn.hide();if(curPage!==1){prevBtn.show();prevBtn.addClass("active")}else prevBtn.hide()}else{if(activeBtn)activeBtn.removeClass("active");if(curPage<view)nextBtn.addClass("active");if(curPage!==1)prevBtn.addClass("active")}};var buttonFunc=function(type){if(!isNaN(type))index=parseInt(type,10)-1;else if(type=="next"){index++;
if(index>view-1)index=0}else{index--;if(index<0)index=view-1}pannelFunc()};var rollingFunc=function(type){if(type=="start")rollingTimer=setInterval(function(){buttonFunc("next")},speed);else clearInterval(rollingTimer)};var mouseenterEvt=function(e){rollingFunc("stop")};var mouseleaveEvt=function(e){rollingFunc("start")};if(rolling){slider.bind({mouseenter:mouseenterEvt,mouseleave:mouseleaveEvt});rollingFunc("start")}var loadFunc=function(){if(item.size()-1<size)slider.find(".recommend-navi").hide();
else slider.find(".recommend-navi").show();if(isDotNaviUse)dotNaviInitFunc();if(item.size()<15&&options.size1hide)button.hide();pannelFunc()};button.unbind("click").bind("click",function(){if($(this).hasClass("next"))buttonFunc("next");else buttonFunc("prev");pannelFunc();if(essentialData.getController()==="home"&&essentialData.getAbTestOptionByKey("2449")==="B")new rocketBadge(slider)});var getDotPage=function(){return slider.find(dotdata["page"])};var dotNaviInitFunc=function(){var $page=$($dotpage.get(0)).clone();
$dotpageWrap.empty();item.each(function(i){var $dot=$page.clone().find(dotNumClass).text(i+1).parent().attr("data-dot-page",i+1);if(i===index)$dot.addClass(dotNowClass);$dotpageWrap.append($dot)});$dotpage=getDotPage();$dotpage.on("click",function(event){event.preventDefault?event.preventDefault():event.returnValue=false;buttonFunc($(this).data("dot-page"))});$dotprev.on("click",function(event){event.preventDefault?event.preventDefault():event.returnValue=false;buttonFunc("prev")});$dotnext.on("click",
function(event){event.preventDefault?event.preventDefault():event.returnValue=false;buttonFunc("next")});slider.on({"mouseenter":function(){$dotroot.stop().slideDown()},"mouseleave":function(){$dotroot.stop().slideUp()}})};var dotNaviPannelFunc=function(){$dotpage.removeClass(dotNowClass);$dotpage.eq(index).addClass(dotNowClass)};loadFunc()},item:function(el,pan){var size=$(el).find(".item").size();var view=Math.ceil(size/pan);var paging=$(el).next(".paging");var counter=paging.find(".counter");var button=
paging.find(".move");var index=0;var pannelFunc=function(){$(el).find(".item").hide();$(el).find(".item").each(function(){var unit=Math.floor($(this).index()/pan);if(unit==index)$(this).show();else $(this).hide()})};pannelFunc();counter.find("em").text(view);counter.find("strong").text(index+1);button.bind({click:function(){if($(this).hasClass("next")){index++;if(index>view-1)index=0}else{index--;if(index<0)index=view-1}pannelFunc();paging.find("strong").text(index+1)}})},selectbox:function(el){var targetElem=
$(el).parent(),action=targetElem.attr("action");targetElem.toggleClass("breadcrumb-open");targetElem.bind({mouseenter:function(){action=true},mouseleave:function(){action=false}});$("body").on("click",function(){if(!action){action=false;targetElem.removeClass("breadcrumb-open")}})},sidebar:function(){var footer=$("#footer");var container=$("section#contents");var sidebar=$("#side-bar");var myview=$("#my-view");var contents=$("#contents");var scroll=$(window).scrollTop();var sideButton=$(".side-button"),
stayPosition=footer.offset().top;var guidedSearchGroup=container.find(".search-wrapper").data("guidedSearchGroup");var applyGuidedSearch=container.find(".search-wrapper").data("applyGuidedSearch");var hasGuidedSearch,hasRelatedKeyword;if(sidebar===undefined||$(sidebar).offset()===undefined)return;if(sidebar.hasClass("freeze")){sidebar.removeClass("side-fix");return}var top=$(sidebar).offset().top+$(sidebar).find(".promotion-banner").height();if(travelCategoryChecker.isTravelLodgingMain($(".sticky-search-travel-bg").data("defaulttab")))top=
top-89;if(applyGuidedSearch){var $guidedSearch=$(".search-guided-container");var $relatedKeyword=$(".search-related-keyword");hasGuidedSearch=$guidedSearch.length>0;hasRelatedKeyword=$relatedKeyword.length>0;top=hasGuidedSearch?$guidedSearch.offset().top+$guidedSearch.innerHeight()-142:hasRelatedKeyword?$relatedKeyword.offset().top+$relatedKeyword.innerHeight()-116:$(".search-header").offset().top}var button=$(sidebar).find(".side-button");var index=0;var setting=function(){if($(container).hasClass("home"))top=
top+$(sidebar).find("#my-view").height()};setting();if(contents.hasClass("home"))if(stayPosition<scroll+$(window).height()){sidebar.removeClass("side-fix");sidebar.addClass("side-stay");sideButton.css("top",contents.height()-112+"px")}else{sidebar.removeClass("side-stay");sidebar.addClass("side-fix");sideButton.css("top","auto")}if(scroll>top){if(!contents.hasClass("home"))sidebar.addClass("side-fix");if(guidedSearchGroup==="B")ui.resetSidebarFix(sidebar,hasGuidedSearch,button);if(guidedSearchGroup===
"C"){ui.scrollFunc();if(scrollDirection==="up")ui.resetSidebarFix(sidebar,hasGuidedSearch,button);else{sidebar.addClass("side-fix").find("#my-view").css("top","10px");sidebar.find(".side-button").css("top","454px")}}if(contents.hasClass("home"))$(sidebar).addClass("bestCategory");else $(sidebar).removeClass("bestCategory");$(button).show()}else{sidebar.removeClass("side-fix");myview.css("margin-left","");$(button).hide()}$(button).find(".top").click(function(){$(window).scrollTop(0,0);$(button).hide()});
$(button).find(".bottom").click(function(){$(window).scrollTop($("body").height())})},resetSidebarFix:function(sidebar,hasGuidedSearch,button){var fixTop="161px",btnTop="613px";if(!hasGuidedSearch){fixTop="135px";btnTop="583px"}sidebar.addClass("side-fix").find("#my-view").css("top",fixTop);sidebar.find(".side-button").css("top",btnTop);if($(window).scrollTop()===0){sidebar.removeClass("side-fix");$(button).hide()}},scrollFunc:function(){if(typeof scrollAction.y=="undefined")scrollAction.y=window.pageYOffset;
var diffY=scrollAction.y-window.pageYOffset;if(diffY<0)scrollDirection="down";else if(diffY>0)scrollDirection="up";else;scrollAction.x=window.pageXOffset;scrollAction.y=window.pageYOffset},input:function(el,type){if(type=="focus"){if(el.value==el.defaultValue)el.value=""}else if(!el.value)el.value=el.defaultValue},popup:function(url,width,height){window.open(url,"popup","width\x3d"+width+",height\x3d"+height+",statusbar\x3dno,scrollbars\x3dyes,toolbar\x3dno")},randomDisplay:function(){var targetElem=
$(".random-image li"),targetBox=$("#homeContentsBanner"),randomImage=Math.floor(Math.random()*targetElem.length),bannerBgColor=$(targetElem[randomImage]).find("a").data("bgcolor");$(targetElem).hide();targetBox.css("background",bannerBgColor);$(targetElem[randomImage]).show()}};return ui});